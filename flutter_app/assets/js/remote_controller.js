"use strict";(()=>{var De=Object.create;var Ce=Object.defineProperty;var Ie=Object.getOwnPropertyDescriptor;var Ee=Object.getOwnPropertyNames;var Te=Object.getPrototypeOf,Ne=Object.prototype.hasOwnProperty;var ie=(l,e)=>()=>(e||l((e={exports:{}}).exports,e),e.exports);var ke=(l,e,c,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let u of Ee(e))!Ne.call(l,u)&&u!==c&&Ce(l,u,{get:()=>e[u],enumerable:!(s=Ie(e,u))||s.enumerable});return l};var b=(l,e,c)=>(c=l!=null?De(Te(l)):{},ke(e||!l||!l.__esModule?Ce(c,"default",{value:l,enumerable:!0}):c,l));var U=ie((Me,be)=>{be.exports=globalThis.React});var M=ie((Ue,xe)=>{xe.exports=globalThis.FuickFramework});var we=ie(ae=>{"use strict";var We=U(),_e=Symbol.for("react.element"),Be=Symbol.for("react.fragment"),He=Object.prototype.hasOwnProperty,$e=We.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ge={key:!0,ref:!0,__self:!0,__source:!0};function ye(l,e,c){var s,u={},x=null,R=null;c!==void 0&&(x=""+c),e.key!==void 0&&(x=""+e.key),e.ref!==void 0&&(R=e.ref);for(s in e)He.call(e,s)&&!Ge.hasOwnProperty(s)&&(u[s]=e[s]);if(l&&l.defaultProps)for(s in e=l.defaultProps,e)u[s]===void 0&&(u[s]=e[s]);return{$$typeof:_e,type:l,key:x,ref:R,props:u,_owner:$e.current}}ae.Fragment=Be;ae.jsx=ye;ae.jsxs=ye});var O=ie((Je,Se)=>{"use strict";Se.exports=we()});var p=b(U()),m=b(M());var K=b(U()),d=b(M());var V=class{static async getDeviceInfo(){return await globalThis.dartCallNative("NetworkDiscovery.getDeviceInfo",{})}static async getLocalIp(){return await globalThis.dartCallNative("NetworkDiscovery.getLocalIp",{})}};V.deviceListeners=[];var g=b(O());function de(){let l=(0,d.useNavigator)(),[e,c]=(0,K.useState)(!1),[s,u]=(0,K.useState)([]),[x,R]=(0,K.useState)(null);(0,K.useEffect)(()=>{X()},[]);let X=async()=>{let T=await V.getDeviceInfo();R(T)},E=()=>{l.push("/controller/connect",{})};return(0,g.jsx)(d.Scaffold,{appBar:(0,g.jsx)(d.AppBar,{title:(0,g.jsxs)(d.Column,{children:[(0,g.jsx)(d.Text,{text:"\u63A7\u5236\u7AEF",fontSize:20,fontWeight:"bold",color:"#FFFFFF"}),x?(0,g.jsx)(d.Text,{text:`\u672C\u673A: ${x.name}`,fontSize:12,color:"#FFFFFF80",margin:{top:4}}):null]}),backgroundColor:"#1976D2"}),children:(0,g.jsx)(d.Container,{color:"#F5F5F5",children:(0,g.jsxs)(d.Column,{children:[(0,g.jsx)(d.Container,{padding:16,children:(0,g.jsx)(d.GestureDetector,{onTap:E,children:(0,g.jsx)(d.Container,{padding:24,decoration:{color:"#FFFFFF",borderRadius:12,boxShadow:{color:"#00000010",blurRadius:8,offset:{dx:0,dy:2}}},children:(0,g.jsxs)(d.Row,{crossAxisAlignment:"center",children:[(0,g.jsx)(d.Container,{padding:12,decoration:{color:"#E3F2FD",borderRadius:50},children:(0,g.jsx)(d.Icon,{name:"add_link",size:28,color:"#1976D2"})}),(0,g.jsx)(d.Expanded,{flex:1,children:(0,g.jsxs)(d.Column,{margin:{left:16},children:[(0,g.jsx)(d.Text,{text:"\u8FDE\u63A5\u65B0\u8BBE\u5907",fontSize:18,fontWeight:"bold",color:"#333333"}),(0,g.jsx)(d.Text,{text:"\u8F93\u5165\u88AB\u63A7\u7AEF\u7684 IP \u5730\u5740\u548C\u7AEF\u53E3\u8FDB\u884C\u8FDE\u63A5",fontSize:14,color:"#666666",margin:{top:4}})]})}),(0,g.jsx)(d.Icon,{name:"chevron_right",size:24,color:"#CCCCCC"})]})})})}),(0,g.jsx)(d.Container,{padding:16,children:(0,g.jsx)(d.Container,{padding:16,decoration:{color:"#FFF3E0",borderRadius:8,border:{width:1,color:"#FFE0B2"}},children:(0,g.jsxs)(d.Row,{crossAxisAlignment:"start",children:[(0,g.jsx)(d.Icon,{name:"help_outline",size:20,color:"#F57C00"}),(0,g.jsx)(d.Expanded,{flex:1,children:(0,g.jsxs)(d.Column,{margin:{left:8},children:[(0,g.jsx)(d.Text,{text:"\u5982\u4F55\u8FDE\u63A5\uFF1F",fontSize:16,fontWeight:"w500",color:"#F57C00"}),(0,g.jsx)(d.Text,{text:"1. \u5728\u88AB\u63A7\u7AEF\u8BBE\u5907\u4E0A\u6253\u5F00\u5E94\u7528\uFF0C\u70B9\u51FB\u201C\u88AB\u63A7\u7AEF\u201D",fontSize:14,color:"#666666",margin:{top:8}}),(0,g.jsx)(d.Text,{text:"2. \u5F00\u542F\u201C\u5C4F\u5E55\u5171\u4EAB\u670D\u52A1\u201D",fontSize:14,color:"#666666",margin:{top:4}}),(0,g.jsx)(d.Text,{text:"3. \u5728\u672C\u9875\u9762\u70B9\u51FB\u201C\u8FDE\u63A5\u65B0\u8BBE\u5907\u201D\uFF0C\u8F93\u5165\u88AB\u63A7\u7AEF\u663E\u793A\u7684 IP \u548C\u7AEF\u53E3",fontSize:14,color:"#666666",margin:{top:4}})]})})]})})})]})})})}var Y=b(U()),i=b(M());var j=b(M()),h=class{static async startServer(e=0){return await globalThis.dartCallNativeAsync("Control.startServer",{port:e})}static async stopServer(){return await globalThis.dartCallNativeAsync("Control.stopServer",{})===!0}static async connectToDevice(e,c){return await globalThis.dartCallNativeAsync("Control.connect",{ip:e,port:c})===!0}static async disconnect(){return await globalThis.dartCallNativeAsync("Control.disconnect",{})===!0}static async connectRelay(e,c,s,u){return await globalThis.dartCallNativeAsync("Control.connectRelay",{ip:e,port:c,deviceId:s,isHost:u})}static async isConnected(){return await globalThis.dartCallNative("Control.isConnected",{})===!0}static async sendClick(e,c){return await globalThis.dartCallNativeAsync("Control.sendClick",{x:e,y:c,duration:50})===!0}static async sendSwipe(e,c,s,u,x=300){return await globalThis.dartCallNativeAsync("Control.sendSwipe",{startX:e,startY:c,endX:s,endY:u,duration:x})===!0}static async sendBack(){return await globalThis.dartCallNativeAsync("Control.sendBack",{})===!0}static async sendHome(){return await globalThis.dartCallNativeAsync("Control.sendHome",{})===!0}static async sendRecent(){return await globalThis.dartCallNativeAsync("Control.sendRecent",{})===!0}static async sendLongPress(e,c,s=1e3){return await globalThis.dartCallNativeAsync("Control.sendLongPress",{x:e,y:c,duration:s})===!0}static async sendText(e){return await globalThis.dartCallNativeAsync("Control.sendText",{text:e})===!0}static async isAccessibilityEnabled(){return await globalThis.dartCallNativeAsync("Control.isAccessibilityEnabled",{})===!0}static async openAccessibilitySettings(){return await globalThis.dartCallNativeAsync("Control.openAccessibilitySettings",{})===!0}static onConnectionStateChange(e){let c=u=>e("connected",u),s=()=>e("disconnected");return j.NativeEvent.on("connected",c),j.NativeEvent.on("disconnected",s),()=>{j.NativeEvent.off("connected",c),j.NativeEvent.off("disconnected",s)}}static onClientConnected(e){let c=s=>e(s);return j.NativeEvent.on("onClientConnected",c),()=>{j.NativeEvent.off("onClientConnected",c)}}};var a=b(O());function me(l){let{device:e}=l,c=(0,i.useNavigator)(),[s,u]=(0,Y.useState)(e?.ip||""),[x,R]=(0,Y.useState)(e?.port?.toString()||"8811"),[X,E]=(0,Y.useState)(!1),[T,k]=(0,Y.useState)(null),[f,Q]=(0,Y.useState)(!1),[w,Z]=(0,Y.useState)("192.168.3.26"),[F,ee]=(0,Y.useState)("8812"),[A,q]=(0,Y.useState)("device_1");return(0,a.jsx)(i.Scaffold,{appBar:(0,a.jsx)(i.AppBar,{title:(0,a.jsx)(i.Text,{text:"\u8FDE\u63A5\u8BBE\u5907",fontSize:20,fontWeight:"bold",color:"#FFFFFF"}),leading:(0,a.jsx)(i.GestureDetector,{onTap:()=>c.pop(),children:(0,a.jsx)(i.Container,{padding:4,children:(0,a.jsx)(i.Icon,{name:"arrow_back",size:24,color:"#FFFFFF"})})}),backgroundColor:"#1976D2"}),children:(0,a.jsxs)(i.Stack,{children:[(0,a.jsx)(i.Container,{color:"#F5F5F5",children:(0,a.jsxs)(i.Container,{padding:24,children:[(0,a.jsxs)(i.Container,{padding:24,decoration:{color:"#FFFFFF",borderRadius:12,boxShadow:{color:"#00000010",blurRadius:8,offset:{dx:0,dy:2}}},children:[(0,a.jsxs)(i.Row,{mainAxisAlignment:"spaceBetween",crossAxisAlignment:"center",margin:{bottom:24},children:[(0,a.jsx)(i.Text,{text:f?"\u901A\u8FC7\u4E2D\u7EE7\u8FDE\u63A5":"\u5C40\u57DF\u7F51\u76F4\u8FDE",fontSize:18,fontWeight:"w500",color:"#333333"}),(0,a.jsxs)(i.Row,{crossAxisAlignment:"center",children:[(0,a.jsx)(i.Text,{text:"\u4E2D\u7EE7\u6A21\u5F0F",fontSize:12,color:"#666666",margin:{right:8}}),(0,a.jsx)(i.Switch,{value:f,onChanged:Q})]})]}),f?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(i.Column,{margin:{bottom:16},children:[(0,a.jsx)(i.Text,{text:"\u4E2D\u7EE7\u670D\u52A1\u5668 IP",fontSize:14,color:"#666666",margin:{bottom:8}}),(0,a.jsx)(i.TextField,{text:w,hintText:"\u4F8B\u5982: 1.2.3.4",onChanged:Z})]}),(0,a.jsxs)(i.Column,{margin:{bottom:16},children:[(0,a.jsx)(i.Text,{text:"\u4E2D\u7EE7\u670D\u52A1\u5668\u7AEF\u53E3",fontSize:14,color:"#666666",margin:{bottom:8}}),(0,a.jsx)(i.TextField,{text:F,hintText:"\u4F8B\u5982: 8888",onChanged:ee})]}),(0,a.jsxs)(i.Column,{margin:{bottom:24},children:[(0,a.jsx)(i.Text,{text:"\u76EE\u6807\u8BBE\u5907 ID",fontSize:14,color:"#666666",margin:{bottom:8}}),(0,a.jsx)(i.TextField,{text:A,hintText:"\u4F8B\u5982: device_1",onChanged:q})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(i.Column,{margin:{bottom:16},children:[(0,a.jsx)(i.Text,{text:"IP \u5730\u5740",fontSize:14,color:"#666666",margin:{bottom:8}}),(0,a.jsx)(i.TextField,{text:s,hintText:"\u4F8B\u5982: 192.168.1.100",onChanged:_=>u(_)})]}),(0,a.jsxs)(i.Column,{margin:{bottom:24},children:[(0,a.jsx)(i.Text,{text:"\u7AEF\u53E3",fontSize:14,color:"#666666",margin:{bottom:8}}),(0,a.jsx)(i.TextField,{text:x,hintText:"\u4F8B\u5982: 8080",onChanged:_=>R(_)})]})]}),T&&(0,a.jsx)(i.Text,{text:T,fontSize:14,color:"#F44336",margin:{bottom:16}}),(0,a.jsx)(i.Button,{text:X?"\u6B63\u5728\u8FDE\u63A5...":"\u7ACB\u5373\u8FDE\u63A5",onTap:async()=>{E(!0),k(null);let _=new Promise(v=>{setTimeout(()=>{v(!1)},15e3)});try{let v;if(f){if(!w||!F||!A){k("\u8BF7\u8F93\u5165\u5B8C\u6574\u7684\u4E2D\u7EE7\u670D\u52A1\u5668\u4FE1\u606F"),E(!1);return}let J=parseInt(F,10);v=await Promise.race([h.connectRelay(w,J,A,!1),_])}else{if(!s||!x){k("\u8BF7\u8F93\u5165 IP \u5730\u5740\u548C\u7AEF\u53E3"),E(!1);return}let J=parseInt(x,10);v=await Promise.race([h.connectToDevice(s,J),_])}E(!1),v&&(v===!0||v.success)?c.push("/controller/control",{device:{name:f?`Relay: ${A}`:e?.name||s,ip:f?w:s,port:parseInt(f?F:x)}}):k(f?"\u8FDE\u63A5\u4E2D\u7EE7\u5931\u8D25: "+(v?.error||"\u672A\u77E5\u9519\u8BEF"):`\u8FDE\u63A5\u5931\u8D25\u6216\u8D85\u65F6\uFF0C\u8BF7\u786E\u4FDD\uFF1A
1. \u4E24\u4E2A\u8BBE\u5907\u5728\u540C\u4E00 Wi-Fi
2. \u88AB\u63A7\u7AEF\u5DF2\u5F00\u542F\u670D\u52A1
3. \u9632\u706B\u5899\u672A\u62E6\u622A`)}catch{E(!1),k("\u8FDE\u63A5\u53D1\u751F\u5F02\u5E38\uFF0C\u8BF7\u91CD\u8BD5")}}})]}),(0,a.jsx)(i.Container,{margin:{top:24},padding:16,children:(0,a.jsxs)(i.Row,{crossAxisAlignment:"center",children:[(0,a.jsx)(i.Icon,{name:"info",size:16,color:"#999999"}),(0,a.jsx)(i.Text,{text:"\u8BF7\u786E\u4FDD\u4E24\u4E2A\u8BBE\u5907\u5728\u540C\u4E00\u4E2A Wi-Fi \u7F51\u7EDC\u4E0B",fontSize:12,color:"#999999",margin:{left:8}})]})})]})}),X&&(0,a.jsx)(i.Positioned,{top:0,bottom:0,left:0,right:0,children:(0,a.jsx)(i.Container,{color:"#00000020",alignment:"center",children:(0,a.jsx)(i.Container,{padding:24,decoration:{color:"#FFFFFF",borderRadius:12},children:(0,a.jsxs)(i.Column,{crossAxisAlignment:"center",children:[(0,a.jsx)(i.CircularProgressIndicator,{color:"#1976D2"}),(0,a.jsx)(i.Text,{text:"\u6B63\u5728\u5EFA\u7ACB\u8FDE\u63A5...",fontSize:14,color:"#333333",margin:{top:16}})]})})})})]})})}var S=b(U()),t=b(M());var ue=b(M()),H=class{static async startCapture(e){return await globalThis.dartCallNative("ScreenCapture.startCapture",{quality:80,maxWidth:1280,maxHeight:720,frameRate:30,...e})===!0}static async stopCapture(){return await globalThis.dartCallNative("ScreenCapture.stopCapture",{})===!0}static onScreenFrame(e){let c=s=>{if(!s)return;let u={data:s.data,timestamp:s.timestamp,width:s.width,height:s.height,originalWidth:s.originalWidth,originalHeight:s.originalHeight};e(u)};return ue.NativeEvent.on("screen_frame",c),()=>{ue.NativeEvent.off("screen_frame",c)}}};var n=b(O());function ge(l){let{device:e}=l,c=(0,t.useNavigator)(),[s,u]=(0,S.useState)(!0),[x,R]=(0,S.useState)(!1),[X,E]=(0,S.useState)(null),[T,k]=(0,S.useState)(null),[f,Q]=(0,S.useState)({width:0,height:0}),[w,Z]=(0,S.useState)({width:0,height:0}),[F,ee]=(0,S.useState)({width:0,height:0}),[A,q]=(0,S.useState)(!0),[te,_]=(0,S.useState)(0),v=(0,S.useRef)({x:0,y:0}),J=(0,S.useRef)(null),oe=(0,S.useRef)(0),ne=(0,S.useRef)(Date.now());(0,S.useEffect)(()=>{e&&re();let C=H.onScreenFrame(y=>{y.data&&k(y.data),oe.current++;let z=Date.now();if(z-ne.current>=1e3&&(_(oe.current),oe.current=0,ne.current=z),typeof y.width=="number"&&typeof y.height=="number"){let G=y.width,L=y.height;Q(W=>W.width===G&&W.height===L?W:{width:G,height:L})}if(typeof y.originalWidth=="number"&&typeof y.originalHeight=="number"){let G=y.originalWidth,L=y.originalHeight;Z(W=>W.width===G&&W.height===L?W:{width:G,height:L})}}),B=h.onConnectionStateChange((y,z)=>{y==="connected"?(R(!0),u(!1)):(R(!1),E("\u8FDE\u63A5\u5DF2\u65AD\u5F00"))});return()=>{C(),B(),h.disconnect()}},[e]);let re=async()=>{if(!e)return;if(await h.isConnected()){R(!0),u(!1);return}u(!0),E(null),await h.connectToDevice(e.ip,e.port)||(E("\u8FDE\u63A5\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC"),u(!1))},N=C=>{if(F.width&&F.height&&f.width&&f.height){let B=F.width/f.width,y=F.height/f.height,z=Math.min(B,y),G=f.width*z,L=f.height*z,W=(F.width-G)/2,se=(F.height-L)/2,ce=C.localPosition.dx,le=C.localPosition.dy,P=(ce-W)/z,D=(le-se)/z;w.width&&w.height?(P=P*(w.width/f.width),D=D*(w.height/f.height)):(P=P*2,D=D*2),v.current={x:P,y:D}}},$=async C=>{if(F.width&&F.height&&f.width&&f.height){let B=F.width/f.width,y=F.height/f.height,z=Math.min(B,y),G=f.width*z,L=f.height*z,W=(F.width-G)/2,se=(F.height-L)/2,ce=C.localPosition.dx,le=C.localPosition.dy,P=(ce-W)/z,D=(le-se)/z;w.width&&w.height?(P=P*(w.width/f.width),D=D*(w.height/f.height)):(P=P*2,D=D*2);let Fe=v.current.x,he=v.current.y;Math.sqrt(Math.pow(P-Fe,2)+Math.pow(D-he,2))<10?await ve(P,D):await Ae(Fe,he,P,D)}},ve=async(C,B)=>{await h.sendClick(C,B)},Ae=async(C,B,y,z)=>{await h.sendSwipe(C,B,y,z,300)},ze=()=>h.sendBack(),Re=()=>h.sendHome(),Pe=()=>h.sendRecent();return s?(0,n.jsx)(t.Scaffold,{appBar:(0,n.jsx)(t.AppBar,{title:(0,n.jsx)(t.Text,{text:"\u6B63\u5728\u8FDE\u63A5...",fontSize:20,fontWeight:"bold",color:"#FFFFFF"}),leading:(0,n.jsx)(t.GestureDetector,{onTap:()=>c.pop(),children:(0,n.jsx)(t.Container,{padding:4,children:(0,n.jsx)(t.Icon,{name:"arrow_back",size:24,color:"#FFFFFF"})})}),backgroundColor:"#1976D2"}),children:(0,n.jsx)(t.Container,{color:"#000000",children:(0,n.jsxs)(t.Column,{mainAxisAlignment:"center",crossAxisAlignment:"center",children:[(0,n.jsx)(t.CircularProgressIndicator,{color:"#1976D2"}),(0,n.jsx)(t.Text,{text:"\u6B63\u5728\u8FDE\u63A5\u8BBE\u5907...",fontSize:16,color:"#FFFFFF",margin:{top:16}}),e&&(0,n.jsx)(t.Text,{text:`${e.name} (${e.ip})`,fontSize:12,color:"#888888",margin:{top:8}})]})})}):X?(0,n.jsx)(t.Scaffold,{appBar:(0,n.jsx)(t.AppBar,{title:(0,n.jsx)(t.Text,{text:"\u8FDE\u63A5\u51FA\u9519",fontSize:20,fontWeight:"bold",color:"#FFFFFF"}),leading:(0,n.jsx)(t.GestureDetector,{onTap:()=>c.pop(),children:(0,n.jsx)(t.Container,{padding:4,children:(0,n.jsx)(t.Icon,{name:"arrow_back",size:24,color:"#FFFFFF"})})}),backgroundColor:"#F44336"}),children:(0,n.jsx)(t.Container,{color:"#000000",children:(0,n.jsxs)(t.Column,{mainAxisAlignment:"center",crossAxisAlignment:"center",padding:32,children:[(0,n.jsx)(t.Icon,{name:"error",size:64,color:"#F44336"}),(0,n.jsx)(t.Text,{text:X,fontSize:16,color:"#FFFFFF",margin:{top:16}}),(0,n.jsx)(t.Button,{text:"\u91CD\u65B0\u8FDE\u63A5",onTap:re,margin:{top:24}})]})})}):(0,n.jsx)(t.Scaffold,{appBar:A?(0,n.jsx)(t.AppBar,{title:(0,n.jsx)(t.Text,{text:e?.name||"\u8FDC\u7A0B\u63A7\u5236",fontSize:20,fontWeight:"bold",color:"#FFFFFF"}),leading:(0,n.jsx)(t.GestureDetector,{onTap:()=>c.pop(),children:(0,n.jsx)(t.Container,{padding:4,children:(0,n.jsx)(t.Icon,{name:"arrow_back",size:24,color:"#FFFFFF"})})}),backgroundColor:"#1976D2"}):void 0,children:(0,n.jsxs)(t.Stack,{children:[(0,n.jsx)(t.Container,{color:"#000000",children:(0,n.jsx)(t.VisibilityDetector,{onVisibilityChanged:C=>{(C.size.width!==F.width||C.size.height!==F.height)&&(ee(C.size),console.log(`[TS] Local size updated: ${C.size.width}x${C.size.height}`))},children:(0,n.jsx)(t.PointerListener,{onPointerDown:C=>N(C),onPointerUp:C=>$(C),children:(0,n.jsx)(t.Container,{alignment:"center",children:T?(0,n.jsx)(t.Image,{url:`data:image/jpeg;base64,${T}`,fit:"contain"}):(0,n.jsxs)(t.Column,{mainAxisAlignment:"center",children:[(0,n.jsx)(t.CircularProgressIndicator,{color:"#1976D2"}),(0,n.jsx)(t.Text,{text:"\u7B49\u5F85\u753B\u9762...",fontSize:14,color:"#888888",margin:{top:16}})]})})})})}),A&&(0,n.jsx)(t.Positioned,{bottom:40,left:20,right:20,children:(0,n.jsxs)(t.Column,{children:[(0,n.jsx)(t.Container,{margin:{bottom:10},padding:4,decoration:{color:"#00000080",borderRadius:4},alignment:"center",children:(0,n.jsx)(t.Text,{text:`FPS: ${te}`,color:"#00FF00",fontSize:12})}),(0,n.jsx)(t.Container,{padding:12,decoration:{color:"#00000080",borderRadius:30},children:(0,n.jsxs)(t.Row,{mainAxisAlignment:"spaceEvenly",children:[(0,n.jsx)(t.GestureDetector,{onTap:ze,children:(0,n.jsx)(t.Container,{padding:8,children:(0,n.jsx)(t.Icon,{name:"arrow_back",size:24,color:"#FFFFFF"})})}),(0,n.jsx)(t.GestureDetector,{onTap:Re,children:(0,n.jsx)(t.Container,{padding:8,children:(0,n.jsx)(t.Icon,{name:"home",size:24,color:"#FFFFFF"})})}),(0,n.jsx)(t.GestureDetector,{onTap:Pe,children:(0,n.jsx)(t.Container,{padding:8,children:(0,n.jsx)(t.Icon,{name:"apps",size:24,color:"#FFFFFF"})})}),(0,n.jsx)(t.GestureDetector,{onTap:()=>q(!1),children:(0,n.jsx)(t.Container,{padding:8,children:(0,n.jsx)(t.Icon,{name:"close",size:24,color:"#FFFFFF"})})})]})})]})}),!A&&(0,n.jsx)(t.Positioned,{bottom:40,right:20,children:(0,n.jsx)(t.GestureDetector,{onTap:()=>q(!0),children:(0,n.jsx)(t.Container,{width:50,height:50,decoration:{color:"#1976D2",borderRadius:25,boxShadow:{color:"#00000040",blurRadius:8,offset:{dx:0,dy:4}}},alignment:"center",children:(0,n.jsx)(t.Icon,{name:"settings",size:24,color:"#FFFFFF"})})})})]})})}var I=b(U()),o=b(M());var r=b(O());function fe(){let l=(0,o.useNavigator)(),[e,c]=(0,I.useState)(!1),[s,u]=(0,I.useState)(0),[x,R]=(0,I.useState)(null),[X,E]=(0,I.useState)(!1),[T,k]=(0,I.useState)(null),[f,Q]=(0,I.useState)("192.168.3.26"),[w,Z]=(0,I.useState)("8812"),[F,ee]=(0,I.useState)("device_1"),[A,q]=(0,I.useState)(!1);(0,I.useEffect)(()=>(te(),()=>{e&&v(),A&&h.disconnect()}),[]);let te=async()=>{let N=await V.getDeviceInfo();R(N)},_=async()=>{let N=await h.startServer(8811);N&&N.success?(c(!0),u(8811),await te(),console.log("[Controlee] Server started")):alert("\u542F\u52A8\u5931\u8D25: "+(N?.error||"\u672A\u77E5\u9519\u8BEF"))},v=async()=>{await H.stopCapture(),await h.stopServer(),c(!1),u(0)},J=async()=>{if(!f||!w||!F){alert("\u8BF7\u8F93\u5165\u5B8C\u6574\u7684\u4E2D\u7EE7\u670D\u52A1\u5668\u4FE1\u606F");return}let N=parseInt(w,10),$=await h.connectRelay(f,N,F,!0);$&&$.success?(q(!0),console.log("\u5DF2\u8FDE\u63A5\u5230\u4E2D\u7EE7\u670D\u52A1\u5668\uFF0C\u7B49\u5F85\u63A7\u5236\u7AEF\u8FDE\u63A5...")):(console.log("\u8FDE\u63A5\u4E2D\u7EE7\u670D\u52A1\u5668\u5931\u8D25: "+($?.error||"\u672A\u77E5\u9519\u8BEF")),q(!1))},oe=async()=>{await h.disconnect(),q(!1),await H.stopCapture()},ne=()=>{e?v():_()};(0,I.useEffect)(()=>h.onClientConnected(async $=>{$.status==="connected"?(k($.client),await H.startCapture({port:s||8811,quality:50,maxWidth:720,maxHeight:1280,frameRate:30})):$.status==="disconnected"&&(k(null),await H.stopCapture())}),[s]);let re=async()=>{await h.disconnect(),await H.stopCapture(),k(null)};return(0,r.jsx)(o.Scaffold,{appBar:(0,r.jsx)(o.AppBar,{title:(0,r.jsxs)(o.Column,{children:[(0,r.jsx)(o.Text,{text:"\u88AB\u63A7\u7AEF",fontSize:20,fontWeight:"bold",color:"#FFFFFF"}),x&&(0,r.jsx)(o.Text,{text:`\u672C\u673A: ${x.name}`,fontSize:12,color:"#FFFFFF80",margin:{top:4}})]}),backgroundColor:"#FF9800"}),children:(0,r.jsx)(o.Container,{color:"#F5F5F5",children:(0,r.jsxs)(o.Column,{children:[(0,r.jsxs)(o.Container,{padding:16,children:[(0,r.jsx)(o.Container,{padding:20,decoration:{color:"#FFFFFF",borderRadius:12,boxShadow:{color:"#00000010",blurRadius:8,offset:{dx:0,dy:2}}},children:(0,r.jsxs)(o.Row,{mainAxisAlignment:"spaceBetween",crossAxisAlignment:"center",children:[(0,r.jsxs)(o.Column,{children:[(0,r.jsx)(o.Text,{text:"\u5C4F\u5E55\u5171\u4EAB\u670D\u52A1",fontSize:18,fontWeight:"w500",color:"#333333"}),(0,r.jsx)(o.Text,{text:e?`\u8FD0\u884C\u4E2D (\u7AEF\u53E3: ${s})`:"\u5DF2\u505C\u6B62",fontSize:14,color:e?"#4CAF50":"#999999",margin:{top:4}})]}),(0,r.jsx)(o.Switch,{value:e,onChanged:ne})]})}),(0,r.jsx)(o.Container,{margin:{top:16},padding:20,decoration:{color:"#FFFFFF",borderRadius:12,boxShadow:{color:"#00000010",blurRadius:8,offset:{dx:0,dy:2}}},children:(0,r.jsxs)(o.Column,{children:[(0,r.jsxs)(o.Row,{mainAxisAlignment:"spaceBetween",crossAxisAlignment:"center",margin:{bottom:16},children:[(0,r.jsxs)(o.Column,{children:[(0,r.jsx)(o.Text,{text:"\u516C\u7F51\u4E2D\u7EE7\u670D\u52A1",fontSize:18,fontWeight:"w500",color:"#333333"}),(0,r.jsx)(o.Text,{text:A?"\u5DF2\u8FDE\u63A5\u4E2D\u7EE7\u670D\u52A1\u5668":"\u672A\u8FDE\u63A5",fontSize:14,color:A?"#4CAF50":"#999999",margin:{top:4}})]}),(0,r.jsx)(o.Switch,{value:A,onChanged:N=>{N?J():oe()}})]}),!A&&(0,r.jsxs)(o.Column,{children:[(0,r.jsx)(o.TextField,{text:f,hintText:"\u4E2D\u7EE7\u670D\u52A1\u5668 IP",onChanged:Q,margin:{bottom:12}}),(0,r.jsx)(o.TextField,{text:w,hintText:"\u7AEF\u53E3 (\u9ED8\u8BA4 8888)",onChanged:Z,margin:{bottom:12}}),(0,r.jsx)(o.TextField,{text:F,hintText:"\u8BBE\u5907 ID (\u552F\u4E00\u6807\u8BC6)",onChanged:ee,margin:{bottom:12}})]}),A&&(0,r.jsx)(o.Container,{margin:{top:8},padding:12,decoration:{color:"#E3F2FD",borderRadius:8},children:(0,r.jsx)(o.Text,{text:`\u8BBE\u5907 ID: ${F}
\u63A7\u5236\u7AEF\u8FDE\u63A5\u65F6\u9700\u8F93\u5165\u6B64 ID`,fontSize:14,color:"#1976D2"})})]})})]}),(0,r.jsx)(o.Expanded,{flex:1,children:(0,r.jsx)(o.Container,{padding:16,children:(0,r.jsxs)(o.Column,{children:[e&&(0,r.jsx)(o.Container,{margin:{top:16},padding:24,decoration:{color:"#FFFFFF",borderRadius:12,boxShadow:{color:"#00000010",blurRadius:8,offset:{dx:0,dy:2}}},children:(0,r.jsxs)(o.Column,{crossAxisAlignment:"center",children:[(0,r.jsx)(o.Text,{text:"\u88AB\u63A7\u7AEF\u8FDE\u63A5\u4FE1\u606F",fontSize:16,fontWeight:"bold",color:"#333333"}),(0,r.jsx)(o.Container,{margin:{top:16},padding:{vertical:12,horizontal:24},decoration:{color:"#F5F5F5",borderRadius:8},children:(0,r.jsx)(o.Text,{text:`${x?.ip||"\u6B63\u5728\u83B7\u53D6 IP..."}:${s}`,fontSize:24,fontWeight:"bold",color:"#1976D2"})}),(0,r.jsx)(o.Text,{text:"\u8BF7\u5728\u63A7\u5236\u7AEF\u8F93\u5165\u4E0A\u65B9\u663E\u793A\u7684 IP \u548C\u7AEF\u53E3",fontSize:12,color:"#999999",margin:{top:12}})]})}),T&&(0,r.jsx)(o.Container,{margin:{top:16},padding:24,decoration:{color:"#FFFFFF",borderRadius:12,boxShadow:{color:"#00000010",blurRadius:8,offset:{dx:0,dy:2}}},children:(0,r.jsxs)(o.Column,{crossAxisAlignment:"center",children:[(0,r.jsxs)(o.Row,{mainAxisAlignment:"center",crossAxisAlignment:"center",children:[(0,r.jsx)(o.Icon,{name:"phonelink_setup",size:24,color:"#4CAF50"}),(0,r.jsx)(o.Text,{text:"\u5DF2\u8FDE\u63A5\u63A7\u5236\u7AEF",fontSize:16,fontWeight:"bold",color:"#333333",margin:{left:8}})]}),(0,r.jsx)(o.Container,{margin:{top:16,bottom:16},padding:{vertical:12,horizontal:24},decoration:{color:"#E8F5E9",borderRadius:8,border:{width:1,color:"#C8E6C9"}},children:(0,r.jsxs)(o.Column,{crossAxisAlignment:"center",children:[(0,r.jsx)(o.Text,{text:T.name||"\u8FDC\u7A0B\u8BBE\u5907",fontSize:18,fontWeight:"bold",color:"#2E7D32"}),(0,r.jsx)(o.Text,{text:`${T.address}:${T.port}`,fontSize:14,color:"#666666",margin:{top:4}})]})}),(0,r.jsx)(o.Button,{text:"\u65AD\u5F00\u8FDE\u63A5",onTap:re})]})}),(0,r.jsx)(o.Container,{margin:{top:16},padding:16,decoration:{color:"#E3F2FD",borderRadius:8,border:{width:1,color:"#BBDEFB"}},children:(0,r.jsxs)(o.Row,{crossAxisAlignment:"start",children:[(0,r.jsx)(o.Icon,{name:"info",size:20,color:"#1976D2"}),(0,r.jsx)(o.Expanded,{flex:1,children:(0,r.jsxs)(o.Column,{margin:{left:8},children:[(0,r.jsx)(o.Text,{text:"\u4F7F\u7528\u8BF4\u660E",fontSize:16,fontWeight:"w500",color:"#1976D2"}),(0,r.jsx)(o.Text,{text:"1. \u5F00\u542F\u5C4F\u5E55\u5171\u4EAB\u670D\u52A1\u540E\uFF0C\u63A7\u5236\u7AEF\u53EF\u4EE5\u901A\u8FC7 IP \u548C\u7AEF\u53E3\u8FDE\u63A5",fontSize:14,color:"#666666",margin:{top:8}}),(0,r.jsx)(o.Text,{text:"2. \u88AB\u63A7\u7AEF\u9700\u8981\u5F00\u542F\u65E0\u969C\u788D\u670D\u52A1\u6743\u9650\u624D\u80FD\u54CD\u5E94\u8FDC\u7A0B\u64CD\u4F5C",fontSize:14,color:"#666666",margin:{top:4}}),(0,r.jsx)(o.Text,{text:"3. \u786E\u4FDD\u63A7\u5236\u7AEF\u548C\u88AB\u63A7\u7AEF\u5728\u540C\u4E00 WiFi \u7F51\u7EDC\u4E0B",fontSize:14,color:"#666666",margin:{top:4}})]})})]})})]})})}),(0,r.jsx)(o.Container,{padding:16,alignment:"center",children:(0,r.jsx)(o.Text,{text:"FuickJS Remote Control",fontSize:12,color:"#CCCCCC"})})]})})})}var Le=l=>p.default.createElement(Oe,{error:l}),Oe=({error:l})=>{let e=(0,m.useNavigator)();return p.default.createElement(m.Container,{color:"#FFEBEE"},p.default.createElement(m.Column,{mainAxisAlignment:"center",crossAxisAlignment:"center",padding:30},p.default.createElement(m.Text,{text:"\u51FA\u9519\u4E86",fontSize:22,color:"#C62828",fontWeight:"bold",margin:{bottom:16}}),p.default.createElement(m.Container,{padding:12,decoration:{color:"#FFFFFF",borderRadius:8,border:{width:1,color:"#FFCDD2"}},margin:{bottom:20}},p.default.createElement(m.Text,{text:l?.message||"\u672A\u77E5\u9519\u8BEF",fontSize:14,color:"#D32F2F",maxLines:5,overflow:"ellipsis"})),p.default.createElement(m.Button,{text:"\u8FD4\u56DE\u9996\u9875",onTap:()=>e.push("/")})))};function pe(){try{m.Runtime.bindGlobals(),(0,m.setGlobalErrorFallback)(Le),m.Router.register("/",()=>p.default.createElement(Ye)),m.Router.register("/controller",()=>p.default.createElement(de)),m.Router.register("/controller/connect",l=>p.default.createElement(me,l)),m.Router.register("/controller/control",l=>p.default.createElement(ge,l)),m.Router.register("/controlee",()=>p.default.createElement(fe))}catch(l){console.error("[RemoteControl] Init error:",l)}}function Ye(){let l=(0,m.useNavigator)();return p.default.createElement(m.Container,{color:"#F5F5F5"},p.default.createElement(m.Column,{mainAxisAlignment:"center",crossAxisAlignment:"center",padding:24},p.default.createElement(m.Text,{text:"\u8FDC\u7A0B\u63A7\u5236",fontSize:28,fontWeight:"bold",color:"#1976D2",margin:{bottom:8}}),p.default.createElement(m.Text,{text:"\u9009\u62E9\u8FD0\u884C\u6A21\u5F0F",fontSize:16,color:"#666",margin:{bottom:48}}),p.default.createElement(m.GestureDetector,{onTap:()=>l.push("/controller")},p.default.createElement(m.Container,{padding:20,margin:{bottom:16},decoration:{color:"#FFFFFF",borderRadius:12,boxShadow:{color:"#00000020",blurRadius:8,offset:{dx:0,dy:2}}}},p.default.createElement(m.Column,{crossAxisAlignment:"start"},p.default.createElement(m.Text,{text:"\u63A7\u5236\u7AEF",fontSize:20,fontWeight:"bold",color:"#4CAF50",margin:{bottom:4}}),p.default.createElement(m.Text,{text:"\u8FDE\u63A5\u5E76\u63A7\u5236\u5176\u4ED6\u8BBE\u5907",fontSize:14,color:"#888"})))),p.default.createElement(m.GestureDetector,{onTap:()=>l.push("/controlee")},p.default.createElement(m.Container,{padding:20,decoration:{color:"#FFFFFF",borderRadius:12,boxShadow:{color:"#00000020",blurRadius:8,offset:{dx:0,dy:2}}}},p.default.createElement(m.Column,{crossAxisAlignment:"start"},p.default.createElement(m.Text,{text:"\u88AB\u63A7\u7AEF",fontSize:20,fontWeight:"bold",color:"#FF9800",margin:{bottom:4}}),p.default.createElement(m.Text,{text:"\u5171\u4EAB\u5C4F\u5E55\u5E76\u63A5\u53D7\u63A7\u5236",fontSize:14,color:"#888"}))))))}globalThis.initApp=pe;pe();})();
/*! Bundled license information:

react/cjs/react-jsx-runtime.production.min.js:
  (**
   * @license React
   * react-jsx-runtime.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)
*/
