"use strict";(()=>{var Re=Object.create;var xe=Object.defineProperty;var ke=Object.getOwnPropertyDescriptor;var Ne=Object.getOwnPropertyNames;var We=Object.getPrototypeOf,Ie=Object.prototype.hasOwnProperty;var ne=(l,e)=>()=>(e||l((e={exports:{}}).exports,e),e.exports);var _e=(l,e,c,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let u of Ne(e))!Ie.call(l,u)&&u!==c&&xe(l,u,{get:()=>e[u],enumerable:!(s=ke(e,u))||s.enumerable});return l};var h=(l,e,c)=>(c=l!=null?Re(We(l)):{},_e(e||!l||!l.__esModule?xe(c,"default",{value:l,enumerable:!0}):c,l));var X=ne((Ve,ye)=>{ye.exports=globalThis.React});var $=ne((je,we)=>{we.exports=globalThis.FuickFramework});var ve=ne(re=>{"use strict";var Be=X(),Ge=Symbol.for("react.element"),Le=Symbol.for("react.fragment"),He=Object.prototype.hasOwnProperty,Ue=Be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Oe={key:!0,ref:!0,__self:!0,__source:!0};function Se(l,e,c){var s,u={},S=null,v=null;c!==void 0&&(S=""+c),e.key!==void 0&&(S=""+e.key),e.ref!==void 0&&(v=e.ref);for(s in e)He.call(e,s)&&!Oe.hasOwnProperty(s)&&(u[s]=e[s]);if(l&&l.defaultProps)for(s in e=l.defaultProps,e)u[s]===void 0&&(u[s]=e[s]);return{$$typeof:Ge,type:l,key:S,ref:v,props:u,_owner:Ue.current}}re.Fragment=Le;re.jsx=Se;re.jsxs=Se});var U=ne((Qe,Te)=>{"use strict";Te.exports=ve()});var p=h(X()),m=h($());var J=h(X()),d=h($());var q=class{static async getDeviceInfo(){return await globalThis.dartCallNative("NetworkDiscovery.getDeviceInfo",{})}static async getLocalIp(){return await globalThis.dartCallNative("NetworkDiscovery.getLocalIp",{})}};q.deviceListeners=[];var g=h(U());function me(){let l=(0,d.useNavigator)(),[e,c]=(0,J.useState)(!1),[s,u]=(0,J.useState)([]),[S,v]=(0,J.useState)(null);(0,J.useEffect)(()=>{R()},[]);let R=async()=>{let G=await q.getDeviceInfo();v(G)},P=()=>{};return(0,g.jsx)(d.Scaffold,{appBar:(0,g.jsx)(d.AppBar,{title:(0,g.jsxs)(d.Column,{children:[(0,g.jsx)(d.Text,{text:"\u63A7\u5236\u7AEF",fontSize:20,fontWeight:"bold",color:"#FFFFFF"}),S?(0,g.jsx)(d.Text,{text:`\u672C\u673A: ${S.name}`,fontSize:12,color:"#FFFFFF80",margin:{top:4}}):null]}),backgroundColor:"#1976D2"}),children:(0,g.jsx)(d.Container,{color:"#F5F5F5",children:(0,g.jsxs)(d.Column,{children:[(0,g.jsx)(d.Container,{padding:16,children:(0,g.jsx)(d.GestureDetector,{onTap:()=>l.push("/controller/p2p",{role:"controller"}),children:(0,g.jsx)(d.Container,{padding:24,decoration:{color:"#FFFFFF",borderRadius:12,boxShadow:{color:"#36303010",blurRadius:8,offset:{dx:0,dy:2}}},children:(0,g.jsxs)(d.Row,{crossAxisAlignment:"center",children:[(0,g.jsx)(d.Container,{padding:12,decoration:{color:"#E8F5E9",borderRadius:50},children:(0,g.jsx)(d.Icon,{name:"compare_arrows",size:28,color:"#43A047"})}),(0,g.jsx)(d.Expanded,{flex:1,children:(0,g.jsxs)(d.Column,{margin:{left:16},children:[(0,g.jsx)(d.Text,{text:"P2P \u76F4\u8FDE",fontSize:18,fontWeight:"bold",color:"#333333"}),(0,g.jsx)(d.Text,{text:"\u65E0\u4E2D\u95F4\u670D\u52A1\u5668\uFF0C\u652F\u6301\u8FDE\u63A5\u7801\u6216 URL \u76F4\u8FDE",fontSize:14,color:"#666666",margin:{top:4}})]})}),(0,g.jsx)(d.Icon,{name:"chevron_right",size:24,color:"#CCCCCC"})]})})})}),(0,g.jsx)(d.Container,{padding:16,children:(0,g.jsx)(d.Container,{padding:16,decoration:{color:"#FFF3E0",borderRadius:8,border:{width:1,color:"#FFE0B2"}},children:(0,g.jsxs)(d.Row,{crossAxisAlignment:"start",children:[(0,g.jsx)(d.Icon,{name:"help_outline",size:20,color:"#F57C00"}),(0,g.jsx)(d.Expanded,{flex:1,children:(0,g.jsxs)(d.Column,{margin:{left:8},children:[(0,g.jsx)(d.Text,{text:"\u5982\u4F55\u8FDE\u63A5\uFF1F",fontSize:16,fontWeight:"w500",color:"#F57C00"}),(0,g.jsx)(d.Text,{text:"1. \u5728\u88AB\u63A7\u7AEF\u8BBE\u5907\u4E0A\u6253\u5F00\u5E94\u7528\uFF0C\u70B9\u51FB\u201C\u88AB\u63A7\u7AEF\u201D",fontSize:14,color:"#666666",margin:{top:8}}),(0,g.jsx)(d.Text,{text:"2. \u70B9\u51FB\u201CP2P \u76F4\u8FDE\u201D\uFF0C\u9009\u62E9\u201C\u6211\u662F\u88AB\u63A7\u7AEF\u201D",fontSize:14,color:"#666666",margin:{top:4}}),(0,g.jsx)(d.Text,{text:"3. \u5728\u672C\u9875\u9762\u70B9\u51FB\u201CP2P \u76F4\u8FDE\u201D\uFF0C\u9009\u62E9\u201C\u6211\u662F\u63A7\u5236\u7AEF\u201D",fontSize:14,color:"#666666",margin:{top:4}}),(0,g.jsx)(d.Text,{text:"4. \u6309\u7167\u6307\u5F15\u4EA4\u6362\u8FDE\u63A5\u7801",fontSize:14,color:"#666666",margin:{top:4}})]})})]})})})]})})})}var w=h(X()),n=h($());var M=h($()),y=class{static async disconnect(){return await globalThis.dartCallNativeAsync("Control.disconnect",{})===!0}static async isConnected(){return await globalThis.dartCallNative("Control.isConnected",{})===!0}static async sendClick(e,c){return await globalThis.dartCallNativeAsync("Control.sendClick",{x:e,y:c,duration:50})===!0}static async sendSwipe(e,c,s,u,S=300){return await globalThis.dartCallNativeAsync("Control.sendSwipe",{startX:e,startY:c,endX:s,endY:u,duration:S})===!0}static async sendBack(){return await globalThis.dartCallNativeAsync("Control.sendBack",{})===!0}static async sendHome(){return await globalThis.dartCallNativeAsync("Control.sendHome",{})===!0}static async sendRecent(){return await globalThis.dartCallNativeAsync("Control.sendRecent",{})===!0}static async sendLongPress(e,c,s=1e3){return await globalThis.dartCallNativeAsync("Control.sendLongPress",{x:e,y:c,duration:s})===!0}static async sendText(e){return await globalThis.dartCallNativeAsync("Control.sendText",{text:e})===!0}static async isAccessibilityEnabled(){return await globalThis.dartCallNativeAsync("Control.isAccessibilityEnabled",{})===!0}static async openAccessibilitySettings(){return await globalThis.dartCallNativeAsync("Control.openAccessibilitySettings",{})===!0}static async copyToClipboard(e){return await globalThis.dartCallNativeAsync("Control.copyToClipboard",{text:e})===!0}static onConnectionStateChange(e){let c=u=>e("connected",u),s=()=>e("disconnected");return M.NativeEvent.on("connected",c),M.NativeEvent.on("disconnected",s),()=>{M.NativeEvent.off("connected",c),M.NativeEvent.off("disconnected",s)}}static onClientConnected(e){let c=s=>e(s);return M.NativeEvent.on("onClientConnected",c),()=>{M.NativeEvent.off("onClientConnected",c)}}};var ue=h($()),Y=class{static async startCapture(e){return await globalThis.dartCallNative("ScreenCapture.startCapture",{quality:80,maxWidth:1280,maxHeight:720,frameRate:30,...e})===!0}static async stopCapture(){return await globalThis.dartCallNative("ScreenCapture.stopCapture",{})===!0}static onScreenFrame(e){let c=s=>{if(!s)return;let u={data:s.data,timestamp:s.timestamp,width:s.width,height:s.height,originalWidth:s.originalWidth,originalHeight:s.originalHeight};e(u)};return ue.NativeEvent.on("screen_frame",c),()=>{ue.NativeEvent.off("screen_frame",c)}}};var N=class{static async startCall(e){return await globalThis.dartCallNativeAsync("WebRTC.startCall",{isCaller:e})}static async stopCall(){return await globalThis.dartCallNativeAsync("WebRTC.stopCall",{})}static async createOfferToken(){return await globalThis.dartCallNativeAsync("WebRTC.createOfferToken",{})}static async createAnswerToken(e){return await globalThis.dartCallNativeAsync("WebRTC.createAnswerToken",{offerToken:e})}static async completeConnection(e){return await globalThis.dartCallNativeAsync("WebRTC.completeConnection",{answerToken:e})}static async startSignalingServer(e=8080){return await globalThis.dartCallNativeAsync("WebRTC.startSignalingServer",{port:e})}static async connectViaUrl(e){return await globalThis.dartCallNativeAsync("WebRTC.connectViaUrl",{url:e})}};var r=h(U());function ge(l){let{device:e}=l,c=(0,n.useNavigator)(),[s,u]=(0,w.useState)(!0),[S,v]=(0,w.useState)(!1),[R,P]=(0,w.useState)(null),[G,O]=(0,w.useState)(null),[F,j]=(0,w.useState)({width:0,height:0}),[I,te]=(0,w.useState)({width:0,height:0}),[b,k]=(0,w.useState)({width:0,height:0}),[T,Q]=(0,w.useState)(!0),[A,oe]=(0,w.useState)(0),Z=(0,w.useRef)({x:0,y:0}),Fe=(0,w.useRef)(null),ee=(0,w.useRef)(0),ae=(0,w.useRef)(Date.now()),ie=async()=>{if(!e)return;await y.isConnected()?(v(!0),u(!1)):(u(!0),setTimeout(async()=>{await y.isConnected()||(P("\u8FDE\u63A5\u8D85\u65F6\uFF0C\u8BF7\u91CD\u8BD5"),u(!1))},3e4))};(0,w.useEffect)(()=>{e&&ie();let C=Y.onScreenFrame(x=>{x.data&&O(x.data),ee.current++;let E=Date.now();if(E-ae.current>=1e3&&(oe(ee.current),ee.current=0,ae.current=E),typeof x.width=="number"&&typeof x.height=="number"){let L=x.width,H=x.height;j(W=>W.width===L&&W.height===H?W:{width:L,height:H})}if(typeof x.originalWidth=="number"&&typeof x.originalHeight=="number"){let L=x.originalWidth,H=x.originalHeight;te(W=>W.width===L&&W.height===H?W:{width:L,height:H})}}),_=y.onConnectionStateChange((x,E)=>{x==="connected"?(v(!0),u(!1),e?.ip!=="P2P"&&N.startCall(!0)):(v(!1),P("\u8FDE\u63A5\u5DF2\u65AD\u5F00"),N.stopCall())});return()=>{C(),_(),N.stopCall(),y.disconnect()}},[e]);let f=C=>{if(b.width&&b.height&&F.width&&F.height){let _=b.width/F.width,x=b.height/F.height,E=Math.min(_,x),L=F.width*E,H=F.height*E,W=(b.width-L)/2,ce=(b.height-H)/2,se=C.localPosition.dx,de=C.localPosition.dy,z=(se-W)/E,D=(de-ce)/E;I.width&&I.height?(z=z*(I.width/F.width),D=D*(I.height/F.height)):(z=z*2,D=D*2),Z.current={x:z,y:D}}},le=async C=>{if(b.width&&b.height&&F.width&&F.height){let _=b.width/F.width,x=b.height/F.height,E=Math.min(_,x),L=F.width*E,H=F.height*E,W=(b.width-L)/2,ce=(b.height-H)/2,se=C.localPosition.dx,de=C.localPosition.dy,z=(se-W)/E,D=(de-ce)/E;I.width&&I.height?(z=z*(I.width/F.width),D=D*(I.height/F.height)):(z=z*2,D=D*2);let he=Z.current.x,be=Z.current.y;Math.sqrt(Math.pow(z-he,2)+Math.pow(D-be,2))<10?await Ee(z,D):await Pe(he,be,z,D)}},Ee=async(C,_)=>{await y.sendClick(C,_)},Pe=async(C,_,x,E)=>{await y.sendSwipe(C,_,x,E,300)},Ae=()=>y.sendBack(),ze=()=>y.sendHome(),De=()=>y.sendRecent();return s?(0,r.jsx)(n.Scaffold,{appBar:(0,r.jsx)(n.AppBar,{title:(0,r.jsx)(n.Text,{text:"\u6B63\u5728\u8FDE\u63A5...",fontSize:20,fontWeight:"bold",color:"#FFFFFF"}),leading:(0,r.jsx)(n.GestureDetector,{onTap:()=>c.pop(),children:(0,r.jsx)(n.Container,{padding:4,children:(0,r.jsx)(n.Icon,{name:"arrow_back",size:24,color:"#FFFFFF"})})}),backgroundColor:"#1976D2"}),children:(0,r.jsx)(n.Container,{color:"#000000",children:(0,r.jsxs)(n.Column,{mainAxisAlignment:"center",crossAxisAlignment:"center",children:[(0,r.jsx)(n.CircularProgressIndicator,{color:"#1976D2"}),(0,r.jsx)(n.Text,{text:"\u6B63\u5728\u8FDE\u63A5\u8BBE\u5907...",fontSize:16,color:"#FFFFFF",margin:{top:16}}),e&&(0,r.jsx)(n.Text,{text:`${e.name} (${e.ip})`,fontSize:12,color:"#888888",margin:{top:8}})]})})}):R?(0,r.jsx)(n.Scaffold,{appBar:(0,r.jsx)(n.AppBar,{title:(0,r.jsx)(n.Text,{text:"\u8FDE\u63A5\u51FA\u9519",fontSize:20,fontWeight:"bold",color:"#FFFFFF"}),leading:(0,r.jsx)(n.GestureDetector,{onTap:()=>c.pop(),children:(0,r.jsx)(n.Container,{padding:4,children:(0,r.jsx)(n.Icon,{name:"arrow_back",size:24,color:"#FFFFFF"})})}),backgroundColor:"#F44336"}),children:(0,r.jsx)(n.Container,{color:"#000000",children:(0,r.jsxs)(n.Column,{mainAxisAlignment:"center",crossAxisAlignment:"center",padding:32,children:[(0,r.jsx)(n.Icon,{name:"error",size:64,color:"#F44336"}),(0,r.jsx)(n.Text,{text:R,fontSize:16,color:"#FFFFFF",margin:{top:16}}),(0,r.jsx)(n.Button,{text:"\u91CD\u65B0\u8FDE\u63A5",onTap:ie,margin:{top:24}})]})})}):(0,r.jsx)(n.Scaffold,{appBar:T?(0,r.jsx)(n.AppBar,{title:(0,r.jsx)(n.Text,{text:e?.name||"\u8FDC\u7A0B\u63A7\u5236",fontSize:20,fontWeight:"bold",color:"#FFFFFF"}),leading:(0,r.jsx)(n.GestureDetector,{onTap:()=>c.pop(),children:(0,r.jsx)(n.Container,{padding:4,children:(0,r.jsx)(n.Icon,{name:"arrow_back",size:24,color:"#FFFFFF"})})}),backgroundColor:"#1976D2"}):void 0,children:(0,r.jsxs)(n.Stack,{children:[(0,r.jsx)(n.Container,{color:"#000000",children:(0,r.jsx)(n.VisibilityDetector,{onVisibilityChanged:C=>{(C.size.width!==b.width||C.size.height!==b.height)&&(k(C.size),console.log(`[TS] Local size updated: ${C.size.width}x${C.size.height}`))},children:(0,r.jsx)(n.PointerListener,{onPointerDown:C=>f(C),onPointerUp:C=>le(C),children:(0,r.jsx)(n.Container,{alignment:"center",children:G?(0,r.jsx)(n.Image,{url:`data:image/jpeg;base64,${G}`,fit:"contain"}):(0,r.jsxs)(n.Column,{mainAxisAlignment:"center",children:[(0,r.jsx)(n.CircularProgressIndicator,{color:"#1976D2"}),(0,r.jsx)(n.Text,{text:"\u7B49\u5F85\u753B\u9762...",fontSize:14,color:"#888888",margin:{top:16}})]})})})})}),T&&(0,r.jsx)(n.Positioned,{bottom:40,left:20,right:20,children:(0,r.jsxs)(n.Column,{children:[(0,r.jsx)(n.Container,{margin:{bottom:10},padding:4,decoration:{color:"#00000080",borderRadius:4},alignment:"center",children:(0,r.jsx)(n.Text,{text:`FPS: ${A}`,color:"#00FF00",fontSize:12})}),(0,r.jsx)(n.Container,{padding:12,decoration:{color:"#00000080",borderRadius:30},children:(0,r.jsxs)(n.Row,{mainAxisAlignment:"spaceEvenly",children:[(0,r.jsx)(n.GestureDetector,{onTap:Ae,children:(0,r.jsx)(n.Container,{padding:8,children:(0,r.jsx)(n.Icon,{name:"arrow_back",size:24,color:"#FFFFFF"})})}),(0,r.jsx)(n.GestureDetector,{onTap:ze,children:(0,r.jsx)(n.Container,{padding:8,children:(0,r.jsx)(n.Icon,{name:"home",size:24,color:"#FFFFFF"})})}),(0,r.jsx)(n.GestureDetector,{onTap:De,children:(0,r.jsx)(n.Container,{padding:8,children:(0,r.jsx)(n.Icon,{name:"apps",size:24,color:"#FFFFFF"})})}),(0,r.jsx)(n.GestureDetector,{onTap:()=>Q(!1),children:(0,r.jsx)(n.Container,{padding:8,children:(0,r.jsx)(n.Icon,{name:"close",size:24,color:"#FFFFFF"})})})]})})]})}),!T&&(0,r.jsx)(n.Positioned,{bottom:40,right:20,children:(0,r.jsx)(n.GestureDetector,{onTap:()=>Q(!0),children:(0,r.jsx)(n.Container,{width:50,height:50,decoration:{color:"#1976D2",borderRadius:25,boxShadow:{color:"#00000040",blurRadius:8,offset:{dx:0,dy:4}}},alignment:"center",children:(0,r.jsx)(n.Icon,{name:"settings",size:24,color:"#FFFFFF"})})})})]})})}var K=h(X()),a=h($());var i=h(U());function pe(){let l=(0,a.useNavigator)(),[e,c]=(0,K.useState)(null),[s,u]=(0,K.useState)(null);(0,K.useEffect)(()=>(S(),()=>{}),[]);let S=async()=>{let R=await q.getDeviceInfo();c(R)};(0,K.useEffect)(()=>y.onClientConnected(async P=>{P.status==="connected"?(u(P.client),await Y.startCapture({port:8811,quality:50,maxWidth:720,maxHeight:1280,frameRate:30})):P.status==="disconnected"&&(u(null),await Y.stopCapture())}),[]);let v=async()=>{await y.disconnect(),await Y.stopCapture(),u(null)};return(0,i.jsx)(a.Scaffold,{appBar:(0,i.jsx)(a.AppBar,{title:(0,i.jsxs)(a.Column,{children:[(0,i.jsx)(a.Text,{text:"\u88AB\u63A7\u7AEF",fontSize:20,fontWeight:"bold",color:"#FFFFFF"}),e&&(0,i.jsx)(a.Text,{text:`\u672C\u673A: ${e.name}`,fontSize:12,color:"#FFFFFF80",margin:{top:4}})]}),backgroundColor:"#FF9800"}),children:(0,i.jsx)(a.Container,{color:"#F5F5F5",children:(0,i.jsxs)(a.Column,{children:[(0,i.jsx)(a.Container,{padding:16,children:(0,i.jsx)(a.GestureDetector,{onTap:()=>l.push("/controller/p2p",{role:"controlee"}),children:(0,i.jsx)(a.Container,{padding:24,decoration:{color:"#FFFFFF",borderRadius:12,boxShadow:{color:"#00000010",blurRadius:8,offset:{dx:0,dy:2}}},children:(0,i.jsxs)(a.Row,{crossAxisAlignment:"center",children:[(0,i.jsx)(a.Container,{padding:12,decoration:{color:"#E8F5E9",borderRadius:50},children:(0,i.jsx)(a.Icon,{name:"compare_arrows",size:28,color:"#43A047"})}),(0,i.jsx)(a.Expanded,{flex:1,children:(0,i.jsxs)(a.Column,{margin:{left:16},children:[(0,i.jsx)(a.Text,{text:"P2P \u76F4\u8FDE",fontSize:18,fontWeight:"bold",color:"#333333"}),(0,i.jsx)(a.Text,{text:"\u65E0\u4E2D\u95F4\u670D\u52A1\u5668\uFF0C\u652F\u6301\u8FDE\u63A5\u7801\u6216 URL \u76F4\u8FDE",fontSize:14,color:"#666666",margin:{top:4}})]})}),(0,i.jsx)(a.Icon,{name:"chevron_right",size:24,color:"#CCCCCC"})]})})})}),(0,i.jsx)(a.Expanded,{flex:1,children:(0,i.jsx)(a.Container,{padding:16,children:(0,i.jsxs)(a.Column,{children:[s&&(0,i.jsx)(a.Container,{margin:{top:16},padding:24,decoration:{color:"#FFFFFF",borderRadius:12,boxShadow:{color:"#00000010",blurRadius:8,offset:{dx:0,dy:2}}},children:(0,i.jsxs)(a.Column,{crossAxisAlignment:"center",children:[(0,i.jsxs)(a.Row,{mainAxisAlignment:"center",crossAxisAlignment:"center",children:[(0,i.jsx)(a.Icon,{name:"phonelink_setup",size:24,color:"#4CAF50"}),(0,i.jsx)(a.Text,{text:"\u5DF2\u8FDE\u63A5\u63A7\u5236\u7AEF",fontSize:16,fontWeight:"bold",color:"#333333",margin:{left:8}})]}),(0,i.jsx)(a.Container,{margin:{top:16,bottom:16},padding:{vertical:12,horizontal:24},decoration:{color:"#E8F5E9",borderRadius:8,border:{width:1,color:"#C8E6C9"}},children:(0,i.jsxs)(a.Column,{crossAxisAlignment:"center",children:[(0,i.jsx)(a.Text,{text:s.name||"\u8FDC\u7A0B\u8BBE\u5907",fontSize:18,fontWeight:"bold",color:"#2E7D32"}),(0,i.jsx)(a.Text,{text:"P2P \u8FDE\u63A5",fontSize:14,color:"#666666",margin:{top:4}})]})}),(0,i.jsx)(a.Button,{text:"\u65AD\u5F00\u8FDE\u63A5",onTap:v})]})}),(0,i.jsx)(a.Container,{margin:{top:16},padding:16,decoration:{color:"#E3F2FD",borderRadius:8,border:{width:1,color:"#BBDEFB"}},children:(0,i.jsxs)(a.Row,{crossAxisAlignment:"start",children:[(0,i.jsx)(a.Icon,{name:"info",size:20,color:"#1976D2"}),(0,i.jsx)(a.Expanded,{flex:1,children:(0,i.jsxs)(a.Column,{margin:{left:8},children:[(0,i.jsx)(a.Text,{text:"\u4F7F\u7528\u8BF4\u660E",fontSize:16,fontWeight:"w500",color:"#1976D2"}),(0,i.jsx)(a.Text,{text:"1. \u70B9\u51FB\u201CP2P \u76F4\u8FDE\u201D\uFF0C\u9009\u62E9\u201C\u6211\u662F\u88AB\u63A7\u7AEF\u201D",fontSize:14,color:"#666666",margin:{top:8}}),(0,i.jsx)(a.Text,{text:"2. \u590D\u5236\u751F\u6210\u7684\u8FDE\u63A5\u7801\u53D1\u9001\u7ED9\u63A7\u5236\u7AEF",fontSize:14,color:"#666666",margin:{top:4}}),(0,i.jsx)(a.Text,{text:"3. \u7C98\u8D34\u63A7\u5236\u7AEF\u7684\u54CD\u5E94\u7801\u4EE5\u5B8C\u6210\u8FDE\u63A5",fontSize:14,color:"#666666",margin:{top:4}}),(0,i.jsx)(a.Text,{text:"4. \u786E\u4FDD\u88AB\u63A7\u7AEF\u5DF2\u5F00\u542F\u65E0\u969C\u788D\u670D\u52A1\u6743\u9650",fontSize:14,color:"#666666",margin:{top:4}})]})})]})})]})})}),(0,i.jsx)(a.Container,{padding:16,alignment:"center",children:(0,i.jsx)(a.Text,{text:"FuickJS Remote Control",fontSize:12,color:"#CCCCCC"})})]})})})}var B=h(X()),t=h($());var o=h(U()),V=({text:l,onTap:e,backgroundColor:c,textColor:s,disabled:u,margin:S})=>(0,o.jsx)(t.GestureDetector,{onTap:u?()=>{}:e,children:(0,o.jsx)(t.Container,{padding:{vertical:12,horizontal:24},decoration:{color:u?"#CCCCCC":c||"#1976D2",borderRadius:8},alignment:"center",margin:S,children:(0,o.jsx)(t.Text,{text:l,color:s||"#FFFFFF",fontSize:16,fontWeight:"bold"})})});function fe(l){let e=(0,t.useNavigator)(),[c,s]=(0,B.useState)("manual"),[u,S]=(0,B.useState)(l.role||"controller"),[v,R]=(0,B.useState)(1),[P,G]=(0,B.useState)(""),[O,F]=(0,B.useState)(""),[j,I]=(0,B.useState)(""),[te,b]=(0,B.useState)(null),[k,T]=(0,B.useState)(!1),[Q,A]=(0,B.useState)(""),oe=async f=>{if(f)try{await y.copyToClipboard(f)}catch(le){console.error("Copy failed",le)}},Z=async()=>{T(!0);try{let f=await N.createOfferToken();G(f),R(2)}catch(f){A("\u751F\u6210\u5931\u8D25: "+f.message)}finally{T(!1)}},Fe=async()=>{if(P){T(!0);try{let f=await N.createAnswerToken(P);F(f),R(2)}catch(f){A("\u751F\u6210\u5931\u8D25: "+f.message)}finally{T(!1)}}},ee=async()=>{if(O){T(!0);try{await N.completeConnection(O),setTimeout(()=>{e.push("/controller/control",{device:{name:"P2P Device",ip:"P2P",port:0}})},1e3)}catch(f){A("\u8FDE\u63A5\u5931\u8D25: "+f.message),T(!1)}}};return(0,o.jsx)(t.Scaffold,{appBar:(0,o.jsx)(t.AppBar,{title:(0,o.jsx)(t.Text,{text:"P2P \u76F4\u8FDE",fontSize:18,color:"#FFFFFF"}),leading:(0,o.jsx)(t.GestureDetector,{onTap:()=>e.pop(),children:(0,o.jsx)(t.Container,{padding:12,children:(0,o.jsx)(t.Icon,{name:"arrow_back",size:24,color:"#FFFFFF"})})}),backgroundColor:"#1976D2"}),children:(0,o.jsx)(t.Container,{padding:16,color:"#F5F5F5",children:(0,o.jsxs)(t.Column,{children:[(0,o.jsx)(t.Container,{margin:{bottom:20},decoration:{color:"white",borderRadius:8},children:(0,o.jsxs)(t.Row,{children:[(0,o.jsx)(t.Expanded,{children:(0,o.jsx)(t.GestureDetector,{onTap:()=>{s("manual"),A("")},children:(0,o.jsxs)(t.Column,{children:[(0,o.jsx)(t.Container,{padding:12,alignment:"center",children:(0,o.jsx)(t.Text,{text:"\u590D\u5236\u7C98\u8D34\u6A21\u5F0F",color:c==="manual"?"#1976D2":"#666",fontWeight:c==="manual"?"bold":"normal"})}),(0,o.jsx)(t.Container,{height:2,color:c==="manual"?"#1976D2":"transparent"})]})})}),(0,o.jsx)(t.Expanded,{children:(0,o.jsx)(t.GestureDetector,{onTap:()=>{s("url"),A("")},children:(0,o.jsxs)(t.Column,{children:[(0,o.jsx)(t.Container,{padding:12,alignment:"center",children:(0,o.jsx)(t.Text,{text:"URL \u76F4\u8FDE\u6A21\u5F0F",color:c==="url"?"#1976D2":"#666",fontWeight:c==="url"?"bold":"normal"})}),(0,o.jsx)(t.Container,{height:2,color:c==="url"?"#1976D2":"transparent"})]})})})]})}),(0,o.jsx)(t.Container,{padding:16,decoration:{color:"white",borderRadius:8},children:(0,o.jsxs)(t.Column,{children:[(0,o.jsxs)(t.Row,{margin:{bottom:20},children:[(0,o.jsx)(t.Expanded,{children:(0,o.jsx)(V,{text:"\u6211\u662F\u63A7\u5236\u7AEF",backgroundColor:u==="controller"?"#1976D2":"#E0E0E0",textColor:u==="controller"?"#FFFFFF":"#333333",onTap:()=>{S("controller"),R(1),G(""),F(""),A(""),b(null)},margin:{right:8}})}),(0,o.jsx)(t.Expanded,{children:(0,o.jsx)(V,{text:"\u6211\u662F\u88AB\u63A7\u7AEF",backgroundColor:u==="controlee"?"#1976D2":"#E0E0E0",textColor:u==="controlee"?"#FFFFFF":"#333333",onTap:()=>{S("controlee"),R(1),G(""),F(""),A(""),b(null)},margin:{left:8}})})]}),Q?(0,o.jsx)(t.Text,{text:Q,color:"red",margin:{bottom:10}}):null,c==="manual"?(0,o.jsx)(t.Column,{children:u==="controller"?(0,o.jsxs)(t.Column,{children:[v===1&&(0,o.jsxs)(t.Column,{children:[(0,o.jsx)(t.Text,{text:"1. \u70B9\u51FB\u751F\u6210\u8FDE\u63A5\u7801\uFF0C\u5E76\u53D1\u9001\u7ED9\u88AB\u63A7\u7AEF\u3002",color:"#666",margin:{bottom:10}}),(0,o.jsx)(V,{text:k?"\u751F\u6210\u4E2D...":"\u751F\u6210\u8FDE\u63A5\u7801",backgroundColor:"#4CAF50",textColor:"#FFFFFF",onTap:Z,disabled:k})]}),v>=2&&(0,o.jsxs)(t.Column,{children:[(0,o.jsx)(t.Text,{text:"1. \u8FDE\u63A5\u7801 (\u5DF2\u538B\u7F29\uFF0C\u70B9\u51FB\u590D\u5236):",fontSize:14,margin:{bottom:5}}),(0,o.jsx)(t.GestureDetector,{onTap:()=>oe(P),children:(0,o.jsx)(t.Container,{padding:8,decoration:{border:{width:1,color:"#ccc"},borderRadius:4},height:100,children:(0,o.jsx)(t.Text,{text:P,fontSize:12})})}),(0,o.jsx)(t.Text,{text:"2. \u8F93\u5165\u88AB\u63A7\u7AEF\u7684\u54CD\u5E94\u7801:",fontSize:14,margin:{top:20,bottom:5}}),(0,o.jsx)(t.TextField,{text:O,onChanged:F,hintText:"\u5728\u6B64\u7C98\u8D34\u54CD\u5E94\u7801"}),(0,o.jsx)(V,{text:k?"\u8FDE\u63A5\u4E2D...":"\u5F00\u59CB\u63A7\u5236",backgroundColor:"#1976D2",textColor:"#FFFFFF",margin:{top:20},onTap:ee,disabled:k||!O})]})]}):(0,o.jsxs)(t.Column,{children:[v===1&&(0,o.jsxs)(t.Column,{children:[(0,o.jsx)(t.Text,{text:"1. \u8F93\u5165\u63A7\u5236\u7AEF\u7684\u8FDE\u63A5\u7801:",fontSize:14,margin:{bottom:5}}),(0,o.jsx)(t.TextField,{text:P,onChanged:G,hintText:"\u5728\u6B64\u7C98\u8D34\u8FDE\u63A5\u7801"}),(0,o.jsx)(V,{text:k?"\u751F\u6210\u4E2D...":"\u751F\u6210\u54CD\u5E94\u7801",backgroundColor:"#4CAF50",textColor:"#FFFFFF",margin:{top:20},onTap:Fe,disabled:k||!P})]}),v===2&&(0,o.jsxs)(t.Column,{children:[(0,o.jsx)(t.Text,{text:"2. \u54CD\u5E94\u7801 (\u5DF2\u538B\u7F29\uFF0C\u70B9\u51FB\u590D\u5236):",fontSize:14,margin:{bottom:5}}),(0,o.jsx)(t.GestureDetector,{onTap:()=>oe(O),children:(0,o.jsx)(t.Container,{padding:8,decoration:{border:{width:1,color:"#ccc"},borderRadius:4},height:100,children:(0,o.jsx)(t.Text,{text:O,fontSize:12})})}),(0,o.jsx)(t.Text,{text:"\u7B49\u5F85\u63A7\u5236\u7AEF\u8FDE\u63A5...",color:"green",textAlign:"center",margin:{top:20}})]})]})}):(0,o.jsx)(t.Column,{children:u==="controller"?(0,o.jsxs)(t.Column,{children:[(0,o.jsx)(t.Text,{text:"\u8BF7\u8F93\u5165\u88AB\u63A7\u7AEF\u7684\u4FE1\u4EE4\u670D\u52A1 URL:",fontSize:14,margin:{bottom:5}}),(0,o.jsx)(t.TextField,{text:j,onChanged:I,hintText:"\u4F8B\u5982: http://192.168.1.100:8080"}),(0,o.jsx)(V,{text:k?"\u8FDE\u63A5\u4E2D...":"\u8FDE\u63A5",backgroundColor:"#1976D2",textColor:"#FFFFFF",margin:{top:20},onTap:async()=>{if(j){T(!0);try{let f=await N.connectViaUrl(j);f.success?setTimeout(()=>{e.push("/controller/control",{device:{name:"P2P Device",ip:"P2P",port:0}})},1e3):(A("\u8FDE\u63A5\u5931\u8D25: "+f.error),T(!1))}catch(f){A("\u8FDE\u63A5\u5931\u8D25: "+f.message),T(!1)}}},disabled:k||!j})]}):(0,o.jsx)(t.Column,{children:te?(0,o.jsxs)(t.Column,{children:[(0,o.jsx)(t.Container,{padding:16,decoration:{color:"#E8F5E9",borderRadius:8,border:{width:1,color:"#C8E6C9"}},margin:{bottom:16},children:(0,o.jsxs)(t.Column,{children:[(0,o.jsxs)(t.Row,{children:[(0,o.jsx)(t.Icon,{name:"check_circle",color:"green",size:24}),(0,o.jsx)(t.Text,{text:"\u670D\u52A1\u5DF2\u542F\u52A8",fontSize:16,fontWeight:"bold",color:"green",margin:{left:8}})]}),(0,o.jsx)(t.Text,{text:`\u672C\u5730\u7AEF\u53E3: ${te}`,margin:{top:8}})]})}),(0,o.jsx)(t.Text,{text:"\u4E0B\u4E00\u6B65:",fontWeight:"bold",margin:{bottom:8}}),(0,o.jsx)(t.Text,{text:"1. \u8BF7\u786E\u4FDD\u63A7\u5236\u7AEF\u53EF\u4EE5\u8BBF\u95EE\u6B64\u670D\u52A1\u3002",color:"#666"}),(0,o.jsx)(t.Text,{text:"2. \u5C06\u670D\u52A1\u7684 URL \u53D1\u9001\u7ED9\u63A7\u5236\u7AEF\u3002",color:"#666",margin:{top:4}})]}):(0,o.jsxs)(t.Column,{children:[(0,o.jsx)(t.Text,{text:"\u70B9\u51FB\u542F\u52A8\u672C\u5730\u4FE1\u4EE4\u670D\u52A1\u3002",color:"#666",margin:{bottom:10}}),(0,o.jsx)(V,{text:k?"\u542F\u52A8\u4E2D...":"\u542F\u52A8\u670D\u52A1 (Port 8080)",backgroundColor:"#4CAF50",textColor:"#FFFFFF",onTap:async()=>{T(!0);try{let f=await N.startSignalingServer(8080);f.success?b(f.port||8080):A("\u542F\u52A8\u5931\u8D25: "+f.error)}catch(f){A("\u542F\u52A8\u5931\u8D25: "+f.message)}finally{T(!1)}},disabled:k})]})})})]})})]})})})}var $e=l=>p.default.createElement(Ye,{error:l}),Ye=({error:l})=>{let e=(0,m.useNavigator)();return p.default.createElement(m.Container,{color:"#FFEBEE"},p.default.createElement(m.Column,{mainAxisAlignment:"center",crossAxisAlignment:"center",padding:30},p.default.createElement(m.Text,{text:"\u51FA\u9519\u4E86",fontSize:22,color:"#C62828",fontWeight:"bold",margin:{bottom:16}}),p.default.createElement(m.Container,{padding:12,decoration:{color:"#FFFFFF",borderRadius:8,border:{width:1,color:"#FFCDD2"}},margin:{bottom:20}},p.default.createElement(m.Text,{text:l?.message||"\u672A\u77E5\u9519\u8BEF",fontSize:14,color:"#D32F2F",maxLines:5,overflow:"ellipsis"})),p.default.createElement(m.Button,{text:"\u8FD4\u56DE\u9996\u9875",onTap:()=>e.push("/")})))};function Ce(){try{m.Runtime.bindGlobals(),(0,m.setGlobalErrorFallback)($e),m.Router.register("/",()=>p.default.createElement(Xe)),m.Router.register("/controller",()=>p.default.createElement(me)),m.Router.register("/controller/control",l=>p.default.createElement(ge,l)),m.Router.register("/controller/p2p",l=>p.default.createElement(fe,l)),m.Router.register("/controlee",()=>p.default.createElement(pe))}catch(l){console.error("[RemoteControl] Init error:",l)}}function Xe(){let l=(0,m.useNavigator)();return p.default.createElement(m.Container,{color:"#F5F5F5"},p.default.createElement(m.Column,{mainAxisAlignment:"center",crossAxisAlignment:"center",padding:24},p.default.createElement(m.Text,{text:"\u8FDC\u7A0B\u63A7\u5236",fontSize:28,fontWeight:"bold",color:"#1976D2",margin:{bottom:8}}),p.default.createElement(m.Text,{text:"\u9009\u62E9\u8FD0\u884C\u6A21\u5F0F",fontSize:16,color:"#666",margin:{bottom:48}}),p.default.createElement(m.GestureDetector,{onTap:()=>l.push("/controller")},p.default.createElement(m.Container,{padding:20,margin:{bottom:16},decoration:{color:"#FFFFFF",borderRadius:12,boxShadow:{color:"#00000020",blurRadius:8,offset:{dx:0,dy:2}}}},p.default.createElement(m.Column,{crossAxisAlignment:"start"},p.default.createElement(m.Text,{text:"\u63A7\u5236\u7AEF",fontSize:20,fontWeight:"bold",color:"#4CAF50",margin:{bottom:4}}),p.default.createElement(m.Text,{text:"\u8FDE\u63A5\u5E76\u63A7\u5236\u5176\u4ED6\u8BBE\u5907",fontSize:14,color:"#888"})))),p.default.createElement(m.GestureDetector,{onTap:()=>l.push("/controlee")},p.default.createElement(m.Container,{padding:20,decoration:{color:"#FFFFFF",borderRadius:12,boxShadow:{color:"#00000020",blurRadius:8,offset:{dx:0,dy:2}}}},p.default.createElement(m.Column,{crossAxisAlignment:"start"},p.default.createElement(m.Text,{text:"\u88AB\u63A7\u7AEF",fontSize:20,fontWeight:"bold",color:"#FF9800",margin:{bottom:4}}),p.default.createElement(m.Text,{text:"\u5171\u4EAB\u5C4F\u5E55\u5E76\u63A5\u53D7\u63A7\u5236",fontSize:14,color:"#888"}))))))}globalThis.initApp=Ce;Ce();})();
/*! Bundled license information:

react/cjs/react-jsx-runtime.production.min.js:
  (**
   * @license React
   * react-jsx-runtime.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)
*/
